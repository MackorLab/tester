<!DOCTYPE html>
<html>
<head>
<title>Art Generator</title>
<script>
async function query(data) {
  const response = await fetch(
    "https://api-inference.huggingface.co/models/stabilityai/stable-diffusion-xl-base-1.0",
    {
      headers: { Authorization: "Bearer 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" },
      method: "POST",
      body: JSON.stringify(data),
    }
  );
  const result = await response.blob();
  return result;
}

function generateArt() {
  const apiKey = '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';
  const prompt = 'a dog walking on the beach with sunglasses';
  const numberOfPics = '1';

  const bodyInfo = JSON.stringify({
    "key": apiKey,
    "model_id": "midjourney",
    "prompt": prompt,
    "negative_prompt": "((out of frame)), ((extra fingers)), mutated hands, ((poorly drawn hands)), ((poorly drawn face)), (((mutation))), (((deformed))), (((tiling))), ((naked)), ((tile)), ((fleshpile)), ((ugly)), (((abstract))), blurry, ((bad anatomy)), ((bad proportions)), ((extra limbs)), cloned face, (((skinny))), glitchy, ((extra breasts)), ((double torso)), ((extra arms)), ((extra hands)), ((mangled fingers)), ((missing breasts)), (missing lips), ((ugly face)), ((fat)), ((extra legs)), anime",
    "width": "512",
    "height": "512",
    "samples": numberOfPics,
    "num_inference_steps": "30",
    "safety_checker": "no",
    "enhance_prompt": "yes",
    "seed": null,
    "guidance_scale": 7.5,
    "webhook": null,
    "track_id": null
  });

  const options = {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: bodyInfo
  };

  fetch('https://stablediffusionapi.com/api/v3/dreambooth', options)
    .then(response => response.json())
    .then(data => {
      console.log(data);
      const picAmount = data.output.length;

      for (let i = 0; i < picAmount; i++) {
        const imageUrl = data.output[i];
        const img = document.createElement('img');
        img.src = imageUrl;
        document.getElementById("image-container").appendChild(img);
      }
    })
    .catch(err => {
      // Не выводить ошибку
    });
}

query({ "inputs": "Astronaut riding a horse" }).then(response => {
  const img = document.createElement('img');
  img.src = URL.createObjectURL(response);
  document.getElementById("image-container").appendChild(img);

  generateArt();
});
</script>
</head>
<body>
<div id="image-container"></div>
</body>
</html>
